angular.module("siyfion.sfTypeahead",[]).directive("sfTypeahead",function(){return{restrict:"ACE",scope:{datasets:"=",ngModel:"="},link:function(a,b){var c=!1;b.typeahead(a.datasets),b.bind("typeahead:selected",function(b,d,e){a.$apply(function(){c=!0,a.ngModel=d[e.valueKey],a.selectedDataset=e})}),b.bind("typeahead:autocompleted",function(b,d,e){a.$apply(function(){c=!0,a.ngModel=d[e.valueKey],a.selectedDataset=e})}),b.bind("input",function(){a.$apply(function(){c=!0;var d=b.val();a.ngModel=d})}),a.$watch("ngModel",function(d){if(c)return c=!1,void 0;if($.isArray(a.datasets)){for(var e=0;e<a.datasets.length;e++)if(a.datasets[e].name==a.selectedDataset){var f=a.datasets[e].valueKey;break}}else var f=a.datasets.valueKey;d&&f&&d.hasOwnProperty(f)&&(d=d[f]),b.typeahead("setQuery",d||"")})}}});